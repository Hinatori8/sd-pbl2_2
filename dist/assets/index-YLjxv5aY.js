(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function d(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(e){if(e.ep)return;e.ep=!0;const n=d(e);fetch(e.href,n)}})();/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const M=document.getElementById("prompt-form"),i=document.getElementById("prompt-input"),g=document.getElementById("submit-button"),h=document.querySelector(".button-text"),I=document.querySelector(".spinner"),E=document.getElementById("error-message"),p=document.getElementById("calendar-grid"),J=document.getElementById("month-year"),w=document.getElementById("prev-month"),x=document.getElementById("next-month"),c=document.getElementById("job-modal"),O=document.getElementById("edit-job-form"),C=document.getElementById("close-modal"),D=document.getElementById("delete-job-button"),y=document.getElementById("job-id"),B=document.getElementById("job-title"),L=document.getElementById("job-start-date"),j=document.getElementById("job-end-date"),S=document.getElementById("job-description");let a=new Date,l=JSON.parse(localStorage.getItem("calendarJobs")||"[]");function v(t){t?(h.style.display="none",I.style.display="block",g.disabled=!0,i.disabled=!0):(h.style.display="block",I.style.display="none",g.disabled=!1,i.disabled=!1)}function F(t){E.textContent=t,E.style.display="block"}function f(){localStorage.setItem("calendarJobs",JSON.stringify(l)),u()}function u(){p.innerHTML="",a.setDate(1);const t=a.getFullYear(),o=a.getMonth();J.textContent=`${t} / ${o+1}`;const d=new Date(t,o,1).getDay(),r=new Date(t,o+1,0).getDate();for(let e=0;e<d;e++){const n=document.createElement("div");n.classList.add("empty"),p.appendChild(n)}for(let e=1;e<=r;e++){const n=`${t}-${String(o+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`,s=document.createElement("div");s.classList.add("day"),s.dataset.date=n,s.textContent=String(e),l.filter(b=>b.startDate<=n&&b.endDate>=n).length&&s.classList.add("has-job"),s.addEventListener("click",()=>k(n)),p.appendChild(s)}}async function N(t){t.preventDefault();const o=i.value.trim();if(o){v(!0);try{const d=await fetch("https://your-app-api.onrender.com/api/schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:o})});if(!d.ok)throw new Error(`API error: ${d.status}`);const r=await d.json();if(!r.title||!r.startDate||!r.endDate)throw new Error("AIからの応答に必要な情報が含まれていません。");const e={id:Date.now(),title:r.title,startDate:r.startDate,endDate:r.endDate,description:r.description??""};l.push(e),f(),i.value=""}catch(d){console.error(d),F("予定の抽出に失敗しました。入力内容を変えてもう一度お試しください。")}finally{v(!1)}}}function P(t){t.preventDefault();const o=parseInt(y.value,10),d=l.findIndex(r=>r.id===o);d>-1&&(l[d]={id:o,title:B.value,startDate:L.value,endDate:j.value,description:S.value},f()),m()}function $(){const t=parseInt(y.value,10);l=l.filter(o=>o.id!==t),f(),m()}function k(t){y.value="",B.value="",L.value=t,j.value=t,S.value="",D.style.display="none",c.style.display="flex"}function m(){c.style.display="none"}M.addEventListener("submit",N);w.addEventListener("click",()=>{a.setMonth(a.getMonth()-1),u()});x.addEventListener("click",()=>{a.setMonth(a.getMonth()+1),u()});C.addEventListener("click",m);D.addEventListener("click",$);O.addEventListener("submit",P);c.addEventListener("click",t=>{t.target===c&&m()});document.addEventListener("DOMContentLoaded",u);
